<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Sprite</title>
  </head>

  <body>
    <canvas
      id="myCanvas"
      width="300"
      height="300"
      style="border: solid 3px blue"
    >
      Your browser does not support HTML5 Canvas.
    </canvas>
    <script>
      const canvas = document.querySelector("#myCanvas");
      const ctx = canvas.getContext("2d");

      const W = canvas.width,
        H = canvas.height;

      const spriteList = [
        "leftArm",
        "legs",
        "torso",
        "rightArm",
        "head",
        "hair",
        "leftArm-jump",
        "legs-jump",
        "rightArm-jump",
      ];

      loadImages(spriteList);

      function loadImages(names) {
        let loaded = 0;
        names.forEach((name) => {
          const img = new Image();
          img.src = `images/${name}.png`;
          img.onload = () => {
            character.images[name] = img;
            if (++loaded === names.length) setInterval(render, 1000 / 15);
            console.log(loaded);
          };
        });
      }

      //Character parameters
      const character = {
        images: {},
        x: 120,
        y: 250,
        jumping: false,
        jumpHeight: 10,
        breathAmt: 0,
        breathInc: 0.5,
        breathMax: 4,
      };

      function render() {
        ctx.clearRect(0, 0, W, H); // clears the canvas

        ctx.drawImage(character.images["legs"], character.x, character.y);

        //TODO

        character.breathAmt += character.breathInc;
        if (
          character.breathAmt > character.breathMax ||
          character.breathAmt < -character.breathMax
        )
          character.breathInc = -character.breathInc;

        const breath = Math.round(character.breathAmt);

        ctx.drawImage(
          character.images["leftArm"],
          character.x + 40,
          character.y - 42 + breath
        );
        ctx.drawImage(character.images["torso"], character.x, character.y - 50);
        ctx.drawImage(
          character.images["rightArm"],
          character.x - 15,
          character.y - 42 + breath
        );

        ctx.drawImage(
          character.images["head"],
          character.x - 10,
          character.y - 125 + breath
        );
        ctx.drawImage(
          character.images["hair"],
          character.x - 37,
          character.y - 138 + breath
        );
      }

      canvas.addEventListener("click", (event) => {
        if (!character.jumping) {
          character.jumping = true;
        }
      });
    </script>
  </body>
</html>
